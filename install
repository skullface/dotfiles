#  ———————————————————————————————————————————————————————————————————————————
#  One install script to rule them all
#  ———————————————————————————————————————————————————————————————————————————

echo -e "  ⊹　  +  　  *　·   . 　 　 ⊹ .　　 　 ˚  ✫
˚　 ✦ *     · ·     + 　  ✦ 　˚     º. *   + 
　✫ º .    ✫ ✵  　˚   ʰᵉˡˡᵒ    ✫  ⋆    . 　
 ✧ 　 *　　　　 ˚  *  　  ♡ 　  ˚ ✫ 　　    ⋆˚
　 ˚  　 ✹ 　 .  + 　 ⊹    .*  ✦  ·    ✧˚ "
echo -e "             📦 LET’S BOOTSTRAP! 🚀"

# Close any open System Preferences panes
osascript -e 'tell application "System Preferences" to quit'

# Ask for the administrator password upfront
sudo -v

# Keep alive: update existing `sudo` timestamp until `.macos` has finished
while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

# Install Homebrew
echo "==> 🍺 Installing Homebrew…"
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
brew update

# Install requirements
PACKAGES=(
  wget
  node
  rbenv
  gh
  youtube-dl
  imagemagick
  svgo
  thefuck
)

echo "==> 📦 Installing command line packages… owo"
brew install ${PACKAGES[@]}

echo "==> 😎 And now, some programs~"
brew tap homebrew/cask

PROGRAMS_REQ=(
  google-chrome
  firefox
  1password
  keka
  typora
)

PROGRAMS_WORK=(
  slack
  zoomus
  encryptme
)

PROGRAMS_DEV=(
  figma
  contraste
  sim-daltonism
  visual-studio-code
  github-desktop
  dash
  docker
)

PROGRAMS_AV=(
  audio-hjiack
  vlc
  obs
  loom
  handbrake
  kap
)

PROGRAMS_FUN=(
  discord
  spotify
  kindle
)

echo "  Installing required apps…"
brew cask install ${PROGRAMS_REQ[@]}

echo "  Installing apps for work…"
brew cask install ${PROGRAMS_DEV[@]}

echo "  Installing design and development apps…"
brew cask install ${PROGRAMS_DEV[@]}

echo "  Installing audio/video apps…"
brew cask install ${PROGRAMS_DEV[@]}

echo "  Installing fun apps…"
brew cask install ${PROGRAMS_FUN[@]}

echo "  Installing Ergodox config tool…"
brew tap homebrew/cask-drivers
brew cask install zsa-wally

echo "  Cleaning up…"
brew cleanup

# NVM
echo "==> 💚 Installing NVM…"
touch ~/.zshrc
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash

# Fonts
echo "==> 🔠 Installing a few free and open source fonts…"
brew tap homebrew/cask-fonts

FONTS=(
  font-saucecodepro-nerd-font
  font-inconsolata
  font-roboto
  font-inter
  font-black-han-sans
  font-ibm-plex
)

brew cask install ${FONTS[@]}

# Ruby
echo "==> 💎 Initializing Ruby…"
rbenv init
gem install bundler

# Customize Terminal: ohmyzsh
echo "==> 🚀 Customizing Terminal…"
echo "  Installing ohmyzsh and the Spaceship theme…"
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
git clone https://github.com/denysdovhan/spaceship-prompt.git "$ZSH_CUSTOM/themes/spaceship-prompt"
ln -s "$ZSH_CUSTOM/themes/spaceship-prompt/spaceship.zsh-theme" "$ZSH_CUSTOM/themes/spaceship.zsh-theme"

# Customize Terminal: remove
echo "  Removing that “last login” annoying message"
touch ~/.hushlogin

# OSX
echo "==> 🍎 Configuring OSX…"

# Trackpad: Enable tap-to-click
defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad Clicking -bool true
defaults -currentHost write NSGlobalDomain com.apple.mouse.tapBehavior -int 1

# Trackpad: Disable "natural" scroll
defaults write NSGlobalDomain com.apple.swipescrolldirection -bool false

echo "  Trackpad settings set"

# Keyboard: Disable smart quotes
defaults write NSGlobalDomain NSAutomaticQuoteSubstitutionEnabled -bool false

echo "  Keyboard settings set"

# Finder: Always show hidden files
defaults write com.apple.finder AppleShowAllFiles YES

# Finder: Use list view in all Finder windows by default
defaults write com.apple.finder FXPreferredViewStyle -string "Nlsv"

# Finder: Keep folders on top when sorting by name
defaults write com.apple.finder _FXSortFoldersFirst -bool true

# Finder: Show filename extensions by default
defaults write NSGlobalDomain AppleShowAllExtensions -bool true

# Finder: When performing a search, search the current folder by default
defaults write com.apple.finder FXDefaultSearchScope -string "SCcf"

echo "  Finder settings set"

# Dock: move to left side of screen to maximize available vertical space
defaults write com.apple.dock orientation -string left

# Dock: use "scale" app minimization effect
defaults write com.apple.dock mineffect -string scale

# Dock: make icons smaller
defaults write com.apple.dock tilesize -integer 42

# Dock: halve the show/hide animation time 
defaults write com.apple.dock autohide-time-modifier -float 0.5

# Dock: remove delay to show/hide
defaults write com.apple.dock autohide-delay -float 0

echo "  Dock settings set"

echo "  Restarting Finder and Dock…"
sudo killall Finder && killall Dock

echo "==> 👩🏻‍💻 Complete!"
echo "✨💋🌈🍰🌻🌟💫🌱🐱🍿🍓"
echo "HAPPY HACKING OWO"